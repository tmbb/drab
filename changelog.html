<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.17.1">
    <title>CHANGELOG – drab v0.5.6</title>
    <link rel="stylesheet" href="dist/app-110d9134a6.css" />
    
    
      
        <link rel="icon" type="image/png" href="assets/logo.png" />
      
      
    
    <script src="dist/sidebar_items-6fa2c1b3f2.js"></script>
    <link rel="stylesheet" href="assets/makedown.css"/>
  </head>
  <body data-type="extras">
    <script>try { if(localStorage.getItem('night-mode')) document.body.className += ' night-mode'; } catch (e) { }</script>

<div class="main">
<button class="sidebar-toggle">
  <span class="icon-menu" aria-hidden="true"></span>
  <span class="sr-only">Toggle Sidebar</span>
</button>
<section class="sidebar">

  
  <a href="Drab.html" class="sidebar-projectLink">
    <div class="sidebar-projectDetails">
      <h1 class="sidebar-projectName">
        drab
      </h1>
      <h2 class="sidebar-projectVersion">
        v0.5.6
      </h2>
    </div>
    
      <img src="assets/logo.png" alt="drab" class="sidebar-projectImage">
    
  </a>

  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button">
      <span class="icon-search" aria-hidden="true"></span>
    </button>
    <input name="q" type="text" id="search-list" class="search-input" placeholder="search" aria-label="Search" autocomplete="off" />
  </form>

  <ul class="sidebar-listNav">
    <li><a id="extras-list" href="#full-list">Pages</a></li>

    
      <li><a id="modules-list" href="#full-list">Modules</a></li>
    

    
      <li><a id="exceptions-list" href="#full-list">Exceptions</a></li>
    

    
      <li><a id="tasks-list" href="#full-list">Mix Tasks</a></li>
    
  </ul>
  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <div class="content-outer">
    <div id="content" class="content-inner">


<h1>CHANGELOG</h1>
<h1>v0.5.6</h1>
<p>Reverted back #51 - <code class="inline">@conn</code> is available again.</p>
<h1>v0.5.5</h1>
<h3 id="fixes" class="section-heading">
  <a href="#fixes" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Fixes:
</h3>

<ul>
<li>#20 (broadcasting in Phx 1.3)
</li>
<li>#44 (docs for broadcasting)
</li>
<li>#45 (button inside for submits in Firefox)
</li>
<li>#47 (docs and error message updated)
</li>
<li>#51 (removed @conn from living assigns, encrypts assigns)
</li>
</ul>
<h1>v0.5.4</h1>
<p>Fixes for adding templates in a runtime.</p>
<pre><code class="nohighlight makeup"><span class="n">poke</span><span class="w"> </span><span class="n">socket</span><span class="p">,</span><span class="w"> </span><span class="ss">live_partial1</span><span class="p">:</span><span class="w"> </span><span class="n">render_to_string</span><span class="p" data-group-id="44">(</span><span class="s2">&quot;partial1.html&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">color</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;#aaaabb&quot;</span><span class="p" data-group-id="44">)</span><span class="w">
</span><span class="n">poke</span><span class="w"> </span><span class="n">socket</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;partial1.html&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">color</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;red&quot;</span></code></pre>
<h3 id="fixes" class="section-heading">
  <a href="#fixes" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Fixes:
</h3>

<ul>
<li>#37
</li>
<li>#40 (updated documentation for Drab.Live.EExEngine)
</li>
<li>#41
</li>
<li>#34 and #38
</li>
</ul>
<h1>v0.5.3</h1>
<p>Phoenix 1.3 compatibility</p>
<ul>
<li>bugfixes (#19, #36).
</li>
<li><code class="inline">drab.gen.commander</code> works both with Phoenix 1.2 and 1.3
</li>
</ul>
<h1>v0.5.2</h1>
<p>This is a small update to make Drab compatible with Elixir 1.5.
Due to an issue with 1.5.0 (elixir-lang/elixir#6391) Elixir version is fixed on 1.4 or &gt;= 1.5.1.</p>
<h3 id="fixes" class="section-heading">
  <a href="#fixes" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Fixes:
</h3>

<ul>
<li>#26, #27, #30, #31, #33
</li>
</ul>
<h1>v0.5.1</h1>
<h3 id="fixes" class="section-heading">
  <a href="#fixes" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Fixes:
</h3>

<ul>
<li>Transpiled all JS templates, and removed all occurences of <code class="inline">forEach</code> (#22)
</li>
<li>Radio buttons not reported correctly in <code class="inline">sender[&quot;form&quot;]</code> (#23)
</li>
<li>New <code class="inline">:main_phoenix_app</code> config item, in case the app name can’t be read from <code class="inline">mix.exs</code> (#25)
</li>
</ul>
<h3 id="changes" class="section-heading">
  <a href="#changes" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Changes:
</h3>

<ul>
<li><p><code class="inline">sender[:params]</code> contains params normalized to controller type params (#24)</p>
<p>  %{“_csrf” =&gt;
  “1234”, “user[id]” =&gt; “42”, “user[email]” =&gt; “test@test.com”,
  “user[account][id]” =&gt; “99”, “user[account][address][street]” =&gt;
  “123 Any Street”}</p>
<p>becomes:</p>
<p>  %{“_csrf” =&gt; “1234”,
  “user” =&gt; %{“account” =&gt; %{“address” =&gt; %{“street” =&gt; “123 Any Street”},
  “id” =&gt; “99”}, “email” =&gt; “test@test.com”, “id” =&gt; “42”}}</p>
</li>
</ul>
<h3 id="new-features" class="section-heading">
  <a href="#new-features" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  New features:
</h3>

<ul>
<li><code class="inline">Core.Browser.set_url/2</code> to manipulate the browser’s URL bar
</li>
</ul>
<h1>v0.5.0</h1>
<p><strong><em>This version is a major update</em></strong>. The default module, <a href="Drab.Query.html"><code class="inline">Drab.Query</code></a> has been replaced with <a href="Drab.Live.html"><code class="inline">Drab.Live</code></a> and <a href="Drab.Element.html"><code class="inline">Drab.Element</code></a>. Drab is not jQuery dependent by default anymore.</p>
<h2 id="new-modules" class="section-heading">
  <a href="#new-modules" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  New modules
</h2>

<h3 id="drab-live" class="section-heading">
  <a href="#drab-live" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  <a href="Drab.Live.html"><code class="inline">Drab.Live</code></a>
</h3>

<p>Allows to remotely (from the server side) replace the value of the assign in the displayed paged, without re-rendering and reloading the page.</p>
<p>Such template:</p>
<pre><code class="html"><a href="https://<%= @url%>" @style.backgroundColor=<%= @color%>>
  <%= @url %>
</a></code></pre>
<p>can be updates live with <code class="inline">poke/2</code>:</p>
<pre><code class="nohighlight makeup"><span class="n">poke</span><span class="w"> </span><span class="n">socket</span><span class="p">,</span><span class="w"> </span><span class="ss">url</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;tg.pl/drab&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">color</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;red&quot;</span></code></pre>
<h3 id="drab-element" class="section-heading">
  <a href="#drab-element" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  <a href="Drab.Element.html"><code class="inline">Drab.Element</code></a>
</h3>

<p>Query and update displayed page from the server side.</p>
<pre><code class="nohighlight makeup"><span class="n">set_prop</span><span class="w"> </span><span class="n">socket</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;p&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">style</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="46">%{</span><span class="s2">&quot;backgroundColor&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;red&quot;</span><span class="p" data-group-id="46">}</span><span class="w"> </span><span class="c1"># awesome effect</span></code></pre>
<h2 id="broadcasting" class="section-heading">
  <a href="#broadcasting" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Broadcasting
</h2>

<p>Broadcasting functions now get <code class="inline">subject</code> instead of <code class="inline">socket</code>. There is no need to have an active socket to broadcast anymore. Useful when broadcasting from background servers or <code class="inline">ondisconnect</code> callback.</p>
<h2 id="form-parameters-in-sender" class="section-heading">
  <a href="#form-parameters-in-sender" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Form parameters in sender
</h2>

<p>If the event launching element is inside a <code class="inline">&lt;FORM&gt;</code>, it gets a values of all input elements within that form. This is a map, where keys are the element’s <code class="inline">name</code> or <code class="inline">id</code>.</p>
<h2 id="upgrading-from-0-4" class="section-heading">
  <a href="#upgrading-from-0-4" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Upgrading from 0.4
</h2>

<p>Add <a href="Drab.Query.html"><code class="inline">Drab.Query</code></a> and <a href="Drab.Modal.html"><code class="inline">Drab.Modal</code></a> to your commanders:</p>
<pre><code class="nohighlight makeup"><span class="kn">use</span><span class="w"> </span><span class="nc">Drab.Commander</span><span class="p">,</span><span class="w"> </span><span class="ss">module</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="45">[</span><span class="nc">Drab.Query</span><span class="p">,</span><span class="w"> </span><span class="nc">Drab.Modal</span><span class="p" data-group-id="45">]</span></code></pre>
<h2 id="depreciations" class="section-heading">
  <a href="#depreciations" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Depreciations
</h2>

<p>All soft depreciations up to 0.4.1 became hard.</p>
<h2 id="v0-4-1-2017-05-25" class="section-heading">
  <a href="#v0-4-1-2017-05-25" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  v0.4.1 - 2017-05-25
</h2>

<h3 id="new" class="section-heading">
  <a href="#new" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  New:
</h3>

<ul>
<li><code class="inline">render_to_string/2</code> in Commander, a shorthand for <code class="inline">Phoenix.View.render_to_string/3</code>
</li>
</ul>
<h3 id="internal-improvements" class="section-heading">
  <a href="#internal-improvements" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Internal improvements:
</h3>

<ul>
<li>removed jQuery from core JS code; only Drab.Query and Drab.Modal depends on jQuery
</li>
<li>module dependencies (Drab behaviour)
</li>
</ul>
<h2 id="0-4-0" class="section-heading">
  <a href="#0-4-0" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  0.4.0
</h2>

<p>Changes:</p>
<ul>
<li>renamed <code class="inline">execjs/2</code> -&gt; <code class="inline">exec_js/3</code>, <code class="inline">brodcastjs/2</code> -&gt; <code class="inline">broadcast_js/3</code>
</li>
<li><code class="inline">exec_js/3</code> returns tuple {:ok, result} or {:error, reason}
</li>
<li><code class="inline">exec_js!/3</code> raises exceptions on JS error
</li>
<li>configurable timeouts for <code class="inline">exec_js/3</code> and <code class="inline">exec_js!/3</code>
</li>
</ul>
<h2 id="0-3-5" class="section-heading">
  <a href="#0-3-5" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  0.3.5
</h2>

<p>Changes:</p>
<ul>
<li>Drab.Browser with browser related functions, like local time, timezone difference, userAgent, redirect_to
</li>
</ul>
<p>Depreciations:</p>
<ul>
<li>Drab.Core.console moved to Drab.Browser
</li>
</ul>
<h2 id="0-3-4-2017-05-04" class="section-heading">
  <a href="#0-3-4-2017-05-04" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  0.3.4 (2017-05-04)
</h2>

<p>Bug fixes:</p>
<ul>
<li><code class="inline">execute!</code> allows string as the method with parameters
</li>
<li>reverted back the timeout for <code class="inline">execjs/2</code> - it caused troubles and it is not really needed; in case of the
  connectivity failure the whole Drab will die anyway
</li>
</ul>
<h2 id="0-3-3-2017-05-03" class="section-heading">
  <a href="#0-3-3-2017-05-03" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  0.3.3 (2017-05-03)
</h2>

<ul>
<li>precompile Drab templates for better performance; user templates are still interpreted on the fly
</li>
<li>choose the behaviour for broadcasting functions: now may send to <code class="inline">:same_url</code>, <code class="inline">:same_controller</code> or to user
  defined <code class="inline">&quot;topic&quot;</code>
</li>
<li>timeout for <code class="inline">execjs/2</code> (and so for the most of Drab.Query functions); default is 5000 ms and can be changed
  with <code class="inline">config :drab, timeout: xxx|:infinity</code>
</li>
</ul>
<h2 id="0-3-2" class="section-heading">
  <a href="#0-3-2" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  0.3.2
</h2>

<ul>
<li>phoenix version ~&gt; 1.2 (#13)
</li>
<li>warning when user updates <code class="inline">attr: &quot;data-*&quot;</code> - it should be done with <code class="inline">data: *</code> (#14)
</li>
<li>integration tests
</li>
</ul>
<h2 id="0-3-1" class="section-heading">
  <a href="#0-3-1" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  0.3.1
</h2>

<h3 id="new-features" class="section-heading">
  <a href="#new-features" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  New features:
</h3>

<ul>
<li>debugging Drab functions directly from <a href="https://hexdocs.pm/iex/IEx.html"><code class="inline">IEx</code></a> console
</li>
<li>display information when handler die, different for prod and dev
</li>
</ul>
<h2 id="0-3-0" class="section-heading">
  <a href="#0-3-0" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  0.3.0
</h2>

<h3 id="api-changes-and-depreciations" class="section-heading">
  <a href="#api-changes-and-depreciations" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  API Changes and Depreciations:
</h3>

<ul>
<li>Drab.Query.select API changed: now <code class="inline">select(:val)</code> returns first value instead of the list, but all jQuery methods
  have corresponding plural methods, which return a Map of <code class="inline">%{name|id|__undefined_XX =&gt; value}</code>
</li>
</ul>
<p><code class="inline">elixir
# &lt;span name=&quot;first_span&quot; class=&quot;qs_2 small-border&quot;&gt;First span with class qs_2&lt;/span&gt;
# &lt;span id=&quot;second_span&quot; class=&quot;qs_2 small-border&quot;&gt;Second span with class qs_2&lt;/span&gt;
socket |&gt; select(:html, from: &quot;.qs_2&quot;)
# &quot;First span with class qs_2&quot;
socket |&gt; select(:htmls, from: &quot;.qs_2&quot;)
# %{&quot;first_span&quot; =&gt; &quot;First span with class qs_2&quot;, &quot;second_span&quot; =&gt; &quot;Second span with class qs_2&quot;}</code></p>
<ul>
<li><p>depreciated <code class="inline">Drab.Endpoint</code>; Drab now injects in the <code class="inline">UserSocket</code> with <code class="inline">use Drab.Socket</code> (#8). Now
  it is possible to share Drab socket with your code (create your channels)</p>
</li>
<li><p>moved Commander setup to macros instead of use options</p>
</li>
</ul>
<p><code class="inline">elixir
use Drab.Commander
onload :page_loaded
access_session :userid</code></p>
<ul>
<li>renamed JS <code class="inline">launch_event()</code> to <code class="inline">run_handler()</code>
</li>
</ul>
<h3 id="new-features" class="section-heading">
  <a href="#new-features" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  New features:
</h3>

<ul>
<li><a href="Drab.Waiter.html"><code class="inline">Drab.Waiter</code></a> module adds ability to wait for an user response in your function, so you can have a reply
  and continue processing.
</li>
</ul>
<p><code class="inline">elixir
return = waiter(socket) do
  on &quot;selector1&quot;, &quot;event_name1&quot;, fn (sender) -&gt;
    # run when this event is triggered on selector1
  end
  on &quot;selector2&quot;, &quot;event_name2&quot;, fn (sender) -&gt;
    # run when that event is triggered on selector2
  end
  on_timeout 5000, fn -&gt;
    # run after timeout, default: infinity
  end
end</code></p>
<ul>
<li><code class="inline">before_handler</code> callback (to run before each handler); do not process the even handler if <code class="inline">before_handler</code>
  returns nil or false
</li>
</ul>
<p><code class="inline">elixir
before_handler :check_login, except: [:log_in]
def check_login(socket, _dom_sender) do
  get_session(socket, :userid)
end</code></p>
<ul>
<li><code class="inline">after_handler</code>, getting the return value of handler as an argument
</li>
</ul>
<p><code class="inline">after_handler :clean_up
def clean_up(_socket, _dom_sender, handler_return) do
  # some clieanup
end</code></p>
<ul>
<li><code class="inline">Drab.Query.select(:all)</code> - returns a map of return values of all known jQuery methods
</li>
</ul>
<p><code class="inline">elixir
socket |&gt; select(:all, from: &quot;span&quot;)
%{&quot;first_span&quot; =&gt; %{&quot;height&quot; =&gt; 16, &quot;html&quot; =&gt; &quot;First span with class qs_2&quot;, &quot;innerHeight&quot; =&gt; 20, ...</code></p>
<h2 id="0-2-6" class="section-heading">
  <a href="#0-2-6" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  0.2.6
</h2>

<p>Changes:</p>
<ul>
<li>reload drab events in JS after each insert or update
</li>
<li>added event object with specified properties to the dom_sender
</li>
<li>added <code class="inline">debounce</code> function as an option to the event handler
</li>
<li>renamed Drab.Config to Drab.Commander.Config
</li>
</ul>
<h2 id="0-2-5" class="section-heading">
  <a href="#0-2-5" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  0.2.5
</h2>

<p>Changes:</p>
<ul>
<li>handling disconnects (ondisconnect callback)
</li>
<li>keep Store in a permament location (browser store) on demand
</li>
<li>access to Plug Session with <a href="Drab.Core.html#get_session/2"><code class="inline">Drab.Core.get_session/2</code></a>
</li>
</ul>
<h2 id="0-2-4" class="section-heading">
  <a href="#0-2-4" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  0.2.4
</h2>

<p>Fixed:</p>
<ul>
<li>not working in IE11 (#5)
</li>
</ul>
<h2 id="0-2-3" class="section-heading">
  <a href="#0-2-3" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  0.2.3
</h2>

<p>Fixed:</p>
<ul>
<li>not working on iOS9 (#3): changed all ES6 constructs to plain JS
</li>
</ul>
<h2 id="0-2-2" class="section-heading">
  <a href="#0-2-2" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  0.2.2
</h2>

<p>New callbacks and Session housekeeping (renamed to Store)</p>
<p>Changes:</p>
<ul>
<li>new callback: onconnect
</li>
<li>renamed Session to Store to avoid confusion
</li>
</ul>
<h2 id="0-2-1" class="section-heading">
  <a href="#0-2-1" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  0.2.1
</h2>

<p>Introduced Drab Session: the way to access (read-only) the Plug Session map in the Commander.</p>
<p>Changes:</p>
<ul>
<li><code class="inline">use Drab.Endpoint</code> instead of <code class="inline">socket Drab.config.socket, Drab.Socket</code> in endpoint.ex
</li>
<li>Drab Session with value inheritance from the Plug Session
</li>
<li>event handler must return socket, warning in the other case
</li>
</ul>
<p>Fixes:</p>
<ul>
<li>security (#2): checks token in each event call to prevent tampering
</li>
</ul>
<h2 id="0-2-0-2017-01-22" class="section-heading">
  <a href="#0-2-0-2017-01-22" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  0.2.0 (2017-01-22)
</h2>

<p>This version cames with refactored modules and client JS library. It is now modular, so you don’t need
to use jQuery and DOM if you don’t have to.</p>
<p>Changes:</p>
<ul>
<li>extracted Drab core; split the JS templates between modules
</li>
<li>jQuery not required in Drab.Core
</li>
<li>moved Drab.Query.execjs and broadcastjs to Drab.Core.execjs and broadcastjs
</li>
<li>moved Drab.Call.console to Drab.Core.console (and console!)
</li>
<li>renamed Drab.Call to Drab.Modal
</li>
<li>renamed Drab.Templates to Drab.Template
</li>
<li>JS: Drab is global, Drab.launch_event() is available
</li>
</ul>
<h2 id="0-1-1" class="section-heading">
  <a href="#0-1-1" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  0.1.1
</h2>

<p>Changes:</p>
<ul>
<li>added more jQuery methods, like width, position, etc
</li>
<li>cycling
update(:text, set: [“One”, “Two”, “Three”], on: “#thebutton”)
update(:class, set: [“btn-success”, “btn-danger”], on: “#save_button”)
</li>
<li>toggling class
update(:class, toggle: “btn-success”, on: “#btn”)
</li>
</ul>
<p>Fixes:</p>
<ul>
<li>atom leaking issue (#1)
</li>
</ul>
<h2 id="0-1-0" class="section-heading">
  <a href="#0-1-0" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  0.1.0
</h2>

<p>First public version. Very shy.</p>

      <footer class="footer">
        <p>
          <span class="line">
            Built using
            <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" rel="help" target="_blank">ExDoc</a> (v0.17.1),
          </span>
          <span class="line">
            designed by
            <a href="https://twitter.com/dignifiedquire" target="_blank" title="@dignifiedquire">Friedel Ziegelmayer</a>.
            </span>
        </p>
        <button class="night-mode-toggle"><span class="sr-only">Switch theme</span></button>
      </footer>
    </div>
  </div>
</section>
</div>
  <script src="dist/app-4cfb39be16.js"></script>
  <script src="assets/makedown.js"></script>
  </body>
</html>

